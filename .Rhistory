0.5,  0.1,  0.1,  1.0),4,4)
dati<-data.frame(mvrnorm(n,c(0,0,0,0), Sigma = matrixcor))
colnames(dati)<-c("X","Z", "Z1", "Z2")
betacoeff<-c(1,1,1,2)
dati$Y=rpois(n,lambda=exp(betacoeff[1]*dati$X+betacoeff[2]*dati$Z+betacoeff[3]*dati$Z1+betacoeff[4]*dati$Z2))
mod1=flipscores(Y~X+Z+Z1+Z2,data=dati,family="poisson"(link="log"))
summary(mod1)
set.seed(1)
FLIPS=make_flips(n_obs=nrow(mod1$scores),n_flips=mod1$flip_param_call$n_flips)
PVal.Flip=function(mod, betaH0=0,x="Z2", alternative="less", B=5000, flips=FLIPS) {
xvals=model.matrix(mod)[,x]
as.numeric(update(mod,offset=-betaH0*xvals,to_be_tested = x,
flips=flips, alternative=alternative)$p.values)
}
mod.glm=glm(Y~X+Z+Z1+Z2,data=dati,family="poisson")
mod.fs1=flipscores(mod.glm,flips = FLIPS)
mod.fs2=flipscores(formula=mod.glm$formula, family=mod.glm$family, data=mod.glm$data,flips=FLIPS)
summary(mod.fs1)
summary(mod.fs2)
PVal.Flip(mod.fs1, betaH0 = -3)
PVal.Flip(mod.fs1, betaH0 = coefficients(mod.fs2)["Z2"])
#diversi da
PVal.Flip(mod.fs2, betaH0 = -3)
PVal.Flip(mod.fs2, betaH0 = coefficients(mod.fs2)["Z2"])
setwd("../flip")
library(devtools)
check()
check()
build()
build()
build()
build()
build()
round(c((seq(10,5000,length.out=7))),0)
round(c((seq(10,1000,length.out=7))),0)
round(c((seq(10,1000,length.out=10))),0)
round(c((seq(10,5000,length.out=8))),0)
round(c((seq(10,1000,length.out=6))),0)
10^(seq(1,3,length.out=7)))
10^(seq(1,3,length.out=7))
10^(seq(1,4,length.out=7))
10^(seq(1,4,length.out=9))
10^(seq(1,4,length.out=8))
10^(seq(1,4,length.out=7))
10^(seq(1,4,length.out=10))
setwd("../bluetits/")
devtools::check()
pkgbuild::check_build_tools(debug = TRUE)
remove("Rtools")
remove(Rtools)
devtools::check()
pkgbuild::check_build_tools(debug = TRUE)
remove.packages("Rtools")
remove.packages("Rtool")
install.packages("Rtool")
"Rtool" %in% available.packages()[,1]
devtools::check()
devtools::load_all()
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)
# Compute generalized partial correlations for all terms
(results <- gcor(mod))
devtools::load_all()
(results <- gcor(mod))
(results <- gcor(mod))
has_intercept
full_glm$formula
null_frml
null_frml <- "~ 1"
null_model = paste0(null_frml,
sapply(terms,function(i) paste0(setdiff(all_vars,i),collapse   ="+"))
)
null_model
all_vars
sapply(terms,function(i) paste0(setdiff(all_vars,i),collapse   ="+"))
all_vars= c(null_frml,all_vars)
sapply(terms,function(i) paste0(setdiff(all_vars,i),collapse   ="+"))
devtools::load_all()
(results <- gcor(mod))
devtools::load_all()
set.seed(123)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rbinom(n=20,prob=plogis((dt$Z=="C")*2),size=1)
mod=flipscores(Y~Z+X,data=dt,family="binomial",n_flips=1000)
# Compute for specific terms only
(results <- gcor_normalized_binom(mod))
(results <- gcor_normalized_binom(mod))
devtools::load_all()
set.seed(123)
dt <- data.frame(X = rnorm(20),
Z = factor(rep(LETTERS[1:3], length.out = 20)))
dt$Y <- rbinom(n = 20, prob = plogis((dt$Z == "C") * 2), size = 1)
mod <- glm(Y ~ Z + X, data = dt, family = binomial)
# Compute generalized partial correlations for all variables
(results <-  gR2_normalized_binom(mod))
devtools::load_all()
(results <-  gR2_normalized_binom(mod))
devtools::load_all()
(results <-  gR2_normalized_binom(mod))
(results <-  gR2(mod))
(results <-  gR2(mod))
temp$null_glm
temp$X
temp$terms
terms
get_X
devtools::load_all()
(results <-  gR2(mod))
devtools::load_all()
(results <-  gR2(mod))
(results <-  gR2_normalized_binom(mod))
(results <-  gR2_normalized_binom(mod))
devtools::load_all()
(results <-  gR2_normalized_binom(mod))
(results <- gR2(mod))
mod0=glm(Y~0,data=dt,family="poisson")
(results <- gR2(mod, mod0))
mod0=glm(Y~0,data=dt,family="binomial")
(results <- gR2(mod, mod0))
debugSource("~/github/flipscores/R/gR2.R")
devtools::load_all()
rm(list = c("gR2"))
(results <- gR2(mod, mod0))
source("~/github/flipscores/R/gR2.R")
(results <- gR2(mod, mod0))
debugSource("~/github/flipscores/R/gR2.R")
(results <- gR2(mod, mod0))
debugSource("~/github/flipscores/R/gR2.R")
(results <- gR2(mod, mod0))
devtools::load_all()
rm(list = c("gR2"))
(results <- gR2(mod, mod0))
mod=full_glm
full_glm=mod
all.vars(full_glm$formula)
all.vars(full_glm$formula)[-1]
all_vars <- all.vars(full_glm$formula)[-1]
all_vars
terms(full_glm$formula)
debugSource("~/github/flipscores/R/gR2.R")
(results <- gR2(mod, mod0))
(results <- gR2(mod, mod0))
terms
temp=.prepare_for_gR2(full_glm,null_glm,terms)
temp
temp$X
source("~/github/flipscores/R/gR2.R")
source("~/github/flipscores/R/gR2.R")
devtools::load_all()
rm(list = c("gR2"))
devtools::load_all()
(results <- gR2(mod, mod0))
(results <- gR2(mod, mod0))
(results <- gR2(mod, mod0))
terms
temp=lapply(terms,.socket_compute_gR2,full_glm, null_glm)
temp
(results <- gR2(mod, mod0))
debug(.socket_compute_gR2)
(results <- gR2(mod, mod0))
(results <- gR2(mod, mod0))
debug(.socket_compute_gR2)
temp=.prepare_for_gR2(full_glm,null_glm,terms)
debugSource("~/github/flipscores/R/gR2.R")
devtools::load_all()
rm(list = c("gR2"))
devtools::load_all()
(results <- gR2(mod, mod0))
source("~/github/flipscores/R/gR2.R")
devtools::load_all()
rm(list = c("gR2"))
devtools::load_all()
(results <- gR2(mod, mod0))
(results <- gR2(mod))
source("~/github/flipscores/R/gR2.R")
(results <- gcor(mod))
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)
# Compute generalized partial correlations for all terms
(results <- gcor(mod))
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gR2(mod, mod0))
(results <- gcor(mod, mod0))
(results <- gcor(mod))
mod0
(results <- gcor(mod, mod0))
gcor(mod, terms = c("X", "ZC"))
devtools::load_all()
rm(list = c("gR2"))
(results <- gcor(mod, mod0))
missing_vars
all_vars
terms
library(devtools)
document()
install()
usethis::use_pkgdown_github_pages()
devtools::document()
pkgdown::build_home_index(".")
pkgdown::init_site(".")
pkgdown::build_home_index()
?gR2_normalized_binom
set.seed(123)
dt <- data.frame(X = rnorm(20),
Z = factor(rep(LETTERS[1:3], length.out = 20)))
dt$Y <- rbinom(n = 20, prob = plogis((dt$Z == "C") * 2), size = 1)
mod <- glm(Y ~ Z + X, data = dt, family = binomial)
# Compute generalized partial correlations for all variables
(results <-  gR2_normalized_binom(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family=binomial)
(results <-  gR2_normalized_binom(mod, mod0))
# Compute for specific variables only
(results <-  gR2_normalized_binom(mod,terms = c("X","Z")))
pkgdown::build_home_index()
pkgdown::build_home()
pkgdown::build_reference()
pkgdown::build_reference_index()
library(devtools)
load_all()
document()
load_all()
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)
# Compute generalized partial correlations for all terms
(results <- gcor(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gcor(mod, mod0))
# Compute for specific terms only
gcor(mod, terms = c("X", "ZC"))
# Compute generalized normalized partial correlations for all terms
(results <- gcor(mod,normalized=TRUE))
gcor(mod, terms = c("X", "ZC"),normaliz=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
(results <- gcor(mod,normaliz=TRUE))
(results <- gcor(mod,normalize=TRUE))
debug(gcor)
(results <- gcor(mod,normalize=TRUE))
load_all()
(results <- gcor(mod,normalize=TRUE))
set.seed(123)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rbinom(n=20,prob=plogis((dt$Z=="C")*2),size=1)
mod=flipscores(Y~Z+X,data=dt,family="binomial",n_flips=1000)
summary(mod)
(results <- gcor(mod,normalize=TRUE))
gcor_normalized_binom(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)
# Compute generalized partial correlations for all terms
(results <- gcor(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gcor(mod, mod0))
# Compute for specific terms only
gcor(mod, terms = c("X", "ZC"))
#' gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
(results <- gcor(mod, mod0))
gcor(mod, terms = c("X", "ZC"))
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)
# Compute generalized partial correlations for all terms
(results <- gcor(mod))
# Compute for specific terms only
gcor(mod, terms = c("X", "ZC"))
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
all_vars= c(null_frml,all_vars)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
results
results <- data.frame(
terms = paste0("~",terms),
r=results$r,
r_n=results$r_n,
null_model = sapply(terms,function(i) paste0(setdiff(all_vars,i),collapse   ="+")),
algorithm=results$algorithm,
is.exact=results$is.exact)
paste0("~",terms)
results$r
results$r_n
results
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
gcor(mod, terms = c("X", "ZC"),normalize=TRUE)
gR2(mod, terms = c("X", "ZC"),normalize=TRUE)
match.arg()
match.call()
as.list(    match.call())
unlist(    match.call())
as.list(    match.call())
as.list(    match.call())[[1]]
as.list(    match.call())[1]
as.list(    match.call())
unlist(as.list(    match.call()))
as.list(as.list(    match.call()))
as.list(    match.call())[[1]]
as.list(    match.call())[1]
length(as.list(    match.call()))
list(as.list(    match.call()))
(as.list(    match.call())[[1]]
(as.list(    match.call()))[[1]]
((as.list(    match.call()))[[1]])[1]
((as.list(    match.call()))[[1]])
str((as.list(    match.call()))[[1]])
(as.list(    match.call()))
str(as.list(    match.call()))
eval(    match.call(),parent.frame()))
eval(    match.call(),parent.frame())
eval(    match.call(),parent.frame())
match.call()
call=as.list(    match.call())
call$``
call[1]
call[[1]]
call[[1]]
call[[1]]="gR2_normalized_binom"
call[[1]]="gR2_normalized_binom"
call$normalize=NULL
eval(    match.call(),parent.frame())
eval(call,parent.frame())
as.call(call)
as.call("gR2_normalized_binom")
call=as.list(    match.call())
str(call[[1]])
gR2(mod, terms = c("X", "ZC"),normalize=TRUE)
as.call("gR2_normalized_binom")
load_all()
load_all()
gR2(mod, terms = c("X", "ZC"),normalize=TRUE)
res=gR2(mod, terms = c("X", "ZC"),normalize=TRUE)
load_all()
res=gR2(mod, terms = c("X", "ZC"),normalize=TRUE)
res=gR2(mod, terms = c("X", "ZC"))
res=gR2(mod, terms = c("X", "ZC"))
temp=lapply(terms,.socket_compute_gR2,full_glm, null_glm)
#' set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=glm(Y~Z+X,data=dt,family="poisson")
summary(mod)
# Compute generalized partial correlations for all variables
(results <- gR2(mod))
# equivalent to
set.seed(123)
dt <- data.frame(X = rnorm(20),
Z = factor(rep(LETTERS[1:3], length.out = 20)))
dt$Y <- rbinom(n = 20, prob = plogis((dt$Z == "C") * 2), size = 1)
mod <- glm(Y ~ Z + X, data = dt, family = binomial)
# Compute generalized partial correlations for all variables
(results <-  gR2_normalized_binom(mod))
(results <-  gR2(mod,normalize=TRUE))
mod0=glm(Y~1,data=dt,family=binomial)
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod,terms = c("X","Z"),,normalize=TRUE))
(results <-  gR2(mod,terms = c("X","Z"),normalize=TRUE))
load_all()
(results <-  gR2(mod,terms = c("X","Z"),normalize=TRUE))
(results <-  gR2(mod,terms = c("X","Z")))
load_all()
(results <-  gR2(mod,terms = c("X","Z")))
(results <-  gR2(mod,terms = c("X","Z")))
load_all()
(results <-  gR2(mod,terms = c("X","Z")))
(results <-  gR2(mod,terms = c("X","Z")))
load_all()
(results <-  gR2(mod,terms = c("X","Z")))
(results <-  gR2(mod,terms = c("X","Z")))
temp=lapply(terms,.socket_compute_gR2,full_glm, null_glm,adjusted=adjusted)
temp=lapply(terms,.socket_compute_gR2,full_glm, null_glm,adjusted=adjusted)
temp=lapply(terms,.socket_compute_gR2,full_glm, null_glm,adjusted=adjusted)
adjusted
adjusted=ifelse(adjusted,1-(1-gR2)*(n-q)/(n-p_plus_q),NULL)
adjusted=ifelse(adjusted,1-(1-gR2)*(n-q)/(n-p_plus_q),NA)
adjusted
load_all()
(results <-  gR2(mod,terms = c("X","Z")))
set.seed(1)
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=glm(Y~Z+X,data=dt,family="poisson")
summary(mod)
# Compute generalized partial correlations for all variables
(results <- gR2(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gR2(mod, mod0))
# Compute for specific variables only
(results <- gR2(mod,terms = c("X","Z")))
set.seed(123)
dt <- data.frame(X = rnorm(20),
Z = factor(rep(LETTERS[1:3], length.out = 20)))
dt$Y <- rbinom(n = 20, prob = plogis((dt$Z == "C") * 2), size = 1)
mod <- glm(Y ~ Z + X, data = dt, family = binomial)
# Compute generalized partial correlations for all variables
(results <-  gR2(mod,normalize=TRUE))
# equivalent to
mod0=glm(Y~1,data=dt,family=binomial)
(results <-  gR2(mod, mod0,normalize=TRUE))
# Compute for specific variables only
(results <-  gR2(mod,terms = c("X","Z"),normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=glm(Y~Z+X,data=dt,family="poisson")
summary(mod)
# Compute generalized partial correlations for all variables
(results <- gR2(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gR2(mod, mod0))
# Compute for specific variables only
(results <- gR2(mod,terms = c("X","Z")))
set.seed(123)
dt <- data.frame(X = rnorm(20),
Z = factor(rep(LETTERS[1:3], length.out = 20)))
dt$Y <- rbinom(n = 20, prob = plogis((dt$Z == "C") * 2), size = 1)
mod <- glm(Y ~ Z + X, data = dt, family = binomial)
# Compute generalized partial correlations for all variables
(results <-  gR2(mod,normalize=TRUE))
# equivalent to
mod0=glm(Y~1,data=dt,family=binomial)
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
terms
(results <-  gR2(mod, mod0,normalize=TRUE))
terms
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
length(terms)>1
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
(results <-  gR2(mod, mod0,normalize=TRUE))
.socket_compute_gR2_n(terms,full_glm, null_glm,algorithm=algorithm,control=control)
ifelse(algorithm=="multi_start",FALSE,TRUE)
algorithm
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
load_all()
load_all()
(results <-  gR2(mod, mod0,normalize=TRUE))
document()
document()
install()
library(performance)
performance::r2_nagelkerke
performance::r2
performance::r2_nagelkerke
performance:::.r2_nagelkerke
performance::r2
performance:::r2_nagelkerke.glm
?gR2
library(flipscores)
?gR2
?gR2
?lm
?gR2
?gR2
library(flipscores)
?gR2
