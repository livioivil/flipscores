<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Robust testing in GLMs, by sign-flipping score contributions — flipscores • flipscores</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Robust testing in GLMs, by sign-flipping score contributions — flipscores"><meta name="description" content="Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables."><meta property="og:description" content="Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables."><meta property="og:image" content="https://livioivil.github.io/flipscores/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">flipscores</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Robust testing in GLMs, by sign-flipping score contributions</h1>

      <div class="d-none name"><code>flipscores.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flipscores</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, <span class="va">data</span>, score_type <span class="op">=</span> <span class="st">"standardized"</span>,</span>
<span>n_flips <span class="op">=</span> <span class="fl">5000</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>seed <span class="op">=</span> <span class="cn">NULL</span>, to_be_tested <span class="op">=</span> <span class="cn">NULL</span>, flips <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>precompute_flips<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>see <code>glm</code> function. It can also be a model (usually generated by a call to <code>glm</code>); in this case, any other glm-related parameter (e.g. <code>family, data, etc.</code>) are discarded, the function will make use of the ones used to generate the model.
(i.e. <code>formula</code>, <code>family</code>, <code>data</code>, etc) are not considered.  It is <code>NULL</code> by default (i.e. not used).</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>see <code>glm</code> function.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>see <code>glm</code> function.</p></dd>


<dt id="arg-score-type">score_type<a class="anchor" aria-label="anchor" href="#arg-score-type"></a></dt>
<dd><p>The type of score that is computed. It can be "standardized" "orthogonalized", "effective" or "basic".
Both "orthogonalized" and "effective" take into account the nuisance estimation and they provide the same
test statistic. In case of small samples "effective score" might have a slight anti-conservative behaviour.
"standardized effective score" gives a solution for this issue.
"orthogonalized" has a similar intent, note however that in case of a big model matrix, it may be slow.</p></dd>


<dt id="arg-n-flips">n_flips<a class="anchor" aria-label="anchor" href="#arg-n-flips"></a></dt>
<dd><p>The number of random flips of the score contributions. Overwritten with the <code>nrow(flips)</code> when <code>flips</code> is not <code>NULL</code> (see parameter <code>flips</code> for more details).
When <code>n_flips</code> is equal or larger than the maximum number of possible flips (i.e. n^2), all possible flips are performed.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>It can be "greater", "less" or "two.sided" (default)</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>a <code>vector</code> identifying the clustered observations. If <code>NULL</code> (default) observations are assumed to be independent. If <code>id</code> is not <code>NULL</code>, only <code>score_type=="effective"</code> is allowed, yet.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p><code>NULL</code> by default.</p></dd>


<dt id="arg-to-be-tested">to_be_tested<a class="anchor" aria-label="anchor" href="#arg-to-be-tested"></a></dt>
<dd><p>vector of indices or names of coefficients of the glm model to be tested (it is faster than computing every scores and p-values of course).</p></dd>


<dt id="arg-flips">flips<a class="anchor" aria-label="anchor" href="#arg-flips"></a></dt>
<dd><p>matrix fo +1 or -1, the matrix has <code>n_flips</code> rows and n (number of observations) columns</p></dd>


<dt id="arg-precompute-flips">precompute_flips<a class="anchor" aria-label="anchor" href="#arg-precompute-flips"></a></dt>
<dd><p><code>TRUE</code> by default. Overwritten if <code>flips</code> is not <code>NULL</code>. If <code>FALSE</code> the matrix of flips is not computed and the flips are made 'on-the-fly' before computing the test statistics; it may be usefull when <code>flips</code> is very large (see parameter <code>flips</code> for more details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>see <code>glm</code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an object of class <code>flipscores</code>.
See also its methods (<code>summary.flipscores</code>, <code>anova.flipscores</code>, <code>print.flipscores</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>flipscores</code> borrows the same parameters from function <code>glm</code> (and <code>glm.nb</code>). See these helps for more details about parameters such as <code>formula</code>,
<code>data</code>, <code>family</code>. Note: in order to use Negative Binomial family, <code>family</code> reference must have quotes (i.e. <code>family="negbinom"</code>).
 Furthermore, <code>flipscores</code> object contains two extra elements: <code>scores</code>  – i.e. a matrix of n score contributions, one column for each tested coefficient – and <code>Tspace</code> – i.e. a matrix of size <code>n_flips</code> times <code>ncol(scores)</code>. The fist row of  <code>Tspace</code> contains column-wise the test statistics generated by randomly flipping the score contributions, each column refers to the same column of <code>scores</code>, the vector of observed test statistics (i.e. no flips) is in the first row of <code>Tspace</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>"Robust testing in generalized linear models by sign-flipping score contributions" by J.Hemerik, J.Goeman and L.Finos.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="anova.flipscores.html">anova.flipscores</a></code>, <code><a href="flipscores-method.html">summary.flipscores</a></code>, <code>flip</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Livio Finos, Riccardo De Santis, Jesse Hemerik and Jelle Goeman</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span><span class="op">$</span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>,lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">Z</span><span class="op">==</span><span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span><span class="op">=</span><span class="fu">flipscores</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Z</span><span class="op">+</span><span class="va">X</span>,data<span class="op">=</span><span class="va">dt</span>,family<span class="op">=</span><span class="st">"poisson"</span>,n_flips<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flipscores(formula = Y ~ Z + X, family = "poisson", data = dt, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_flips = 1000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate    Score Std. Error  z value Part. Cor Pr(&gt;|z|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.14256 -0.91360    2.62144 -0.34851    -0.127    0.726   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZB          -0.18558 -0.50868    1.65785 -0.30683    -0.108    0.644   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZC           1.40981  8.55380    2.58950  3.30326     0.765    0.006 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X           -0.06964 -1.56935    4.70999 -0.33320    -0.117    0.682   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 28.649  on 19  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 11.218  on 16  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 58.102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Equivalent to:</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Z</span><span class="op">+</span><span class="va">X</span>,data<span class="op">=</span><span class="va">dt</span>,family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span><span class="op">=</span><span class="fu">flipscores</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in model.frame.default(formula = Y ~ Z + X, data = dt, drop.unused.levels = TRUE):</span> 'data' must be a data.frame, environment, or list</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'mod2' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Livio Finos.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

