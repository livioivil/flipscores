<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Robust testing in GLMs, by sign-flipping score contributions — flipscores • flipscores</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Robust testing in GLMs, by sign-flipping score contributions — flipscores"><meta property="og:description" content="Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flipscores</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Robust testing in GLMs, by sign-flipping score contributions</h1>
    
    <div class="hidden name"><code>flipscores.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides robust tests for testing in GLMs, by sign-flipping score contributions. The tests are often robust against overdispersion, heteroscedasticity and, in some cases, ignored nuisance variables.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">flipscores</span><span class="op">(</span><span class="va">formula</span>, <span class="va">family</span>, <span class="va">data</span>, score_type <span class="op">=</span> <span class="st">"standardized"</span>,</span>
<span>n_flips <span class="op">=</span> <span class="fl">5000</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>seed <span class="op">=</span> <span class="cn">NULL</span>, to_be_tested <span class="op">=</span> <span class="cn">NULL</span>, flips <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>precompute_flips <span class="op">=</span> <span class="cn">TRUE</span>, output_flips <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>formula</dt>
<dd><p>see <code>glm</code> function. It can also be a model (usually generated by a call to <code>glm</code>); in this case, any other glm-related parameter (e.g. <code>family, data, etc.</code>) are discarded, the function will make use of the ones used to generate the model. 
(i.e. <code>formula</code>, <code>family</code>, <code>data</code>, etc) are not considered.  It is <code>NULL</code> by default (i.e. not used).</p></dd>


<dt>family</dt>
<dd><p>see <code>glm</code> function.</p></dd>


<dt>data</dt>
<dd><p>see <code>glm</code> function.</p></dd>


<dt>score_type</dt>
<dd><p>The type of score that is computed. It can be "standardized" "orthogonalized", "effective" or "basic". 
Both "orthogonalized" and "effective" take into account the nuisance estimation and they provide the same
test statistic. In case of small samples "effective score" might have a slight anti-conservative behaviour. 
"standardized effective score" gives a solution for this issue.
"orthogonalized" has a similar intent, note however that in case of a big model matrix, it may be slow.</p></dd>


<dt>n_flips</dt>
<dd><p>The number of random flips of the score contributions. Overwritten with the <code>nrow(flips)</code> when <code>flips</code> is not <code>NULL</code> (see parameter <code>flips</code> for more details).
When <code>n_flips</code> is equal or larger than the maximum number of possible flips (i.e. n^2), all possible flips are performed.</p></dd>


<dt>alternative</dt>
<dd><p>It can be "greater", "less" or "two.sided" (default)</p></dd>


<dt>id</dt>
<dd><p>a <code>vector</code> identifying the clustered observations. If <code>NULL</code> (default) observations are assumed to be independent. If <code>id</code> is not <code>NULL</code>, only <code>score_type=="effective"</code> is allowed, yet.</p></dd>


<dt>seed</dt>
<dd><p><code>NULL</code> by default.</p></dd>


<dt>to_be_tested</dt>
<dd><p>vector of indices or names of coefficients of the glm model to be tested (it is faster than computing every scores and p-values of course).</p></dd>


<dt>flips</dt>
<dd><p>matrix fo +1 or -1, the matrix has <code>n_flips</code> rows and n (number of observations) columns</p></dd>


<dt>precompute_flips</dt>
<dd><p><code>TRUE</code> by default. Overwritten if <code>flips</code> is not <code>NULL</code>. If <code>FALSE</code> the matrix of flips is not computed and the flips are made 'on-the-fly' before computing the test statistics; it may be usefull when <code>flips</code> is very large (see parameter <code>flips</code> for more details).</p></dd>


<dt>output_flips</dt>
<dd><p><code>FALSE</code> by default. If <code>TRUE</code> the <code>flips</code> matrix is returned. Useful when the same flips are needed for more glms, for example in the case of multivariate glms where the joint distribution of test statistis if used for multivariate inference.</p></dd>


<dt>...</dt>
<dd><p>see <code>glm</code> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>an object of class <code>flipscores</code>.
See also its methods (<code>summary.flipscores</code>, <code>anova.flipscores</code>, <code>print.flipscores</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>flipscores</code> borrows the same parameters from function <code>glm</code> (and <code>glm.nb</code>). See these helps for more details about parameters such as <code>formula</code>,
<code>data</code>, <code>family</code>. Note: in order to use Negative Binomial family, <code>family</code> reference must have quotes (i.e. <code>family="negbinom"</code>). 
 Furthermore, <code>flipscores</code> object contains two extra elements: <code>scores</code>  -- i.e. a matrix of n score contributions, one column for each tested coefficient -- and <code>Tspace</code> -- i.e. a matrix of size <code>n_flips</code> times <code>ncol(scores)</code>. The fist row of  <code>Tspace</code> contains column-wise the test statistics generated by randomly flipping the score contributions, each column refers to the same column of <code>scores</code>, the vector of observed test statistics (i.e. no flips) is in the first row of <code>Tspace</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>"Robust testing in generalized linear models by sign-flipping score contributions" by J.Hemerik, J.Goeman and L.Finos.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="anova.flipscores.html">anova.flipscores</a></code>, <code><a href="flipscores-method.html">summary.flipscores</a></code>, <code><a href="https://rdrr.io/pkg/flip/man/flip.html" class="external-link">flip</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Livio Finos, Riccardo De Santis, Jesse Hemerik and Jelle Goeman</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>X<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span><span class="op">$</span><span class="va">Y</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span>,lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">Z</span><span class="op">==</span><span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span><span class="op">=</span><span class="fu">flipscores</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Z</span><span class="op">+</span><span class="va">X</span>,data<span class="op">=</span><span class="va">dt</span>,family<span class="op">=</span><span class="st">"poisson"</span>,n_flips<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> flipscores(formula = Y ~ Z + X, family = "poisson", data = dt, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n_flips = 1000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Deviance Residuals: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min       1Q   Median       3Q      Max  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.4796  -0.4363   0.1579   0.3358   0.9899  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate    Score Std. Error  z value Part. Cor Pr(&gt;|z|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.14256 -0.91360    2.62144 -0.34851    -0.127    0.730   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZB          -0.18558 -0.50868    1.65785 -0.30683    -0.108    0.652   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ZC           1.40981  8.55380    2.58950  3.30326     0.765    0.004 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X           -0.06964 -1.56935    4.70999 -0.33320    -0.117    0.677   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Dispersion parameter for poisson family taken to be 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Null deviance: 28.649  on 19  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual deviance: 11.218  on 16  degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 58.102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of Fisher Scoring iterations: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Equivalent to:</span></span></span>
<span class="r-in"><span><span class="va">model</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">Z</span><span class="op">+</span><span class="va">X</span>,data<span class="op">=</span><span class="va">dt</span>,family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span><span class="op">=</span><span class="fu">flipscores</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in model.frame.default(formula = Y ~ Z + X, data = dt, drop.unused.levels = TRUE):</span> 'data' must be a data.frame, environment, or list</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in summary(mod2):</span> object 'mod2' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Livio Finos.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

