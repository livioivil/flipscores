% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcor.R
\name{gcor}
\alias{gcor}
\title{Compute Generalized Partial Correlations for GLM Variables}
\usage{
gcor(full_glm, variables = NULL, intercept_too = FALSE)
}
\arguments{
\item{full_glm}{A fitted GLM object of class `glm`.}

\item{variables}{Character vector of variable names (referred to the
model.matrix, that is pay attention for factors) for which to compute
generalized partial correlations. If `NULL` (default), computes for all
non-intercept variables in the model.}
}
\value{
A data frame with two columns:
  \item{variable}{The variable name}
  \item{r}{The generalized partial correlation coefficient}
}
\description{
This function computes the generalized partial correlation coefficient \eqn{r}
for each specified variable in a generalized linear model. For each variable,
it refits the null model excluding that variable and computes the cosine similarity
between the residualized predictor and standardized residuals.
}
\details{
The generalized partial correlation \eqn{\r} measures the association between
a predictor and response after adjusting for all other variables in the model.
It is defined as the cosine similarity between the residualized predictor
\eqn{X_r} and standardized residuals \eqn{Y_r}:

\deqn{\r = \frac{X_r^\top Y_r}{\|X_r\| \|Y_r\|}}

where:
\itemize{
  \item \eqn{X_r = (I - H)W^{1/2}X} is the residualized predictor
  \item \eqn{Y_r = V^{-1/2}(Y - \hat{\mu})} is the standardized residual vector
  \item \eqn{H} is the hat matrix for the nuisance covariates
  \item \eqn{W = DV^{-1}D} is the weight matrix
  \item \eqn{V} is the variance matrix and \eqn{D} is the derivative matrix
}

The function uses `flipscores:::get_par_expo_fam()` to compute \eqn{V} and \eqn{D}
consistently with the flipscores package methodology.
}
\examples{
set.seed(1)
dt=data.frame(X=rnorm(20),
   Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",n_flips=1000)
summary(mod)

# Compute generalized partial correlations for all variables
(results <- gcor(mod))

# Compute for specific variables only
gcor(mod, variables = c("X", "ZC"))

}
\author{
Livio Finos and Paolo Girardi
}
