% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gR2.R
\name{gR2}
\alias{gR2}
\title{Generalized R-squared for GLM Models}
\usage{
gR2(full_glm, null_glm = NULL, terms = NULL)
}
\arguments{
\item{full_glm}{A fitted GLM object of class `glm` (the full model).}

\item{null_glm}{A fitted GLM object of class `glm` (the null model). If `NULL` (default),
uses an empty model (intercept-only if intercept is present, otherwise no predictors).}

\item{terms}{A character vector of variable names or a formula specifying
the additional terms in the full model compared to the null. If provided,
this overrides `null_glm` and the null model is refitted excluding these terms.}
}
\value{
A numeric value representing the generalized R-squared measure.
}
\description{
Computes the generalized R-squared measure for nested generalized linear models.
The generalized R-squared measures the proportion of "variance" explained by
the additional predictors in the full model compared to the null model.
}
\details{
The generalized R-squared is computed as:

\deqn{gR^2 = \frac{Y_r^\top X_r (X_r^\top X_r)^{-1} X_r^\top Y_r}{Y_r^\top Y_r}}

where:
\itemize{
  \item \eqn{Y_r = V^{-1/2}(Y - \hat{\mu}_0)} is the standardized residual vector from the null model
  \item \eqn{X_r = (I - H)W^{1/2}X} is the residualized additional predictors matrix
  \item \eqn{H} is the hat matrix for the null model
  \item \eqn{W = DV^{-1}D} is the weight matrix
}

This measures the proportion of the standardized residual sum of squares explained
by the additional predictors in the full model.
}
\examples{
set.seed(1)
dt=data.frame(X=rnorm(20),
   Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=glm(Y~Z+X,data=dt,family="poisson")
summary(mod)

# Compute generalized partial correlations for all variables
(results <- gR2(mod))
# equivalent to
mod0=glm(Y~1,data=dt,family="poisson")
(results <- gR2(mod, mod0))

# Compute for specific variables only
(results <- gR2(mod,terms = c("X","Z")))

}
\author{
Livio Finos and Paolo Girardi
}
