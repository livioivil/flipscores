% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gcor_normalized_binom.R
\name{gcor_normalized_binom}
\alias{gcor_normalized_binom}
\title{Normalized Generalized Partial Correlation for Binomial GLMs}
\usage{
gcor_normalized_binom(
  full_glm,
  variables = NULL,
  intercept_too = FALSE,
  algorithm = "auto",
  algorithm.control = list(n_exact = 15, thresholds = c(-0.1, 0, 0.1), n_random = 10,
    max_iter = 1000, topK = 10, tol = 1e-12, patience = 10)
)
}
\arguments{
\item{full_glm}{A fitted GLM object of class `glm` with binomial family.}

\item{variables}{Character vector of variable names for which to compute
normalized correlations. If `NULL` (default), computes for all non-intercept
variables in the model.}

\item{intercept_too}{Logical indicating whether to include the intercept
as a variable. Default is FALSE.}

\item{algorithm.control}{`list` of coltrol parameters:
`n_exact` Integer specifying the sample size threshold for using exact
  methods (brute force). Default is 15.
`thresholds` Numeric vector of threshold values for multi-start initialization.
`n_random` Integer number of random starts for multi-start optimization.
`max_iter` Integer maximum number of iterations per start.
`topK` Integer number of top candidates to consider at each iteration.
`tol` Numeric tolerance for convergence.
`patience` Integer number of iterations without improvement before stopping.}

\item{algorith}{`"auto"` by default. It choose between `"intercept_only"`, `"brute_force"` and `"multi_start"`}
}
\value{
A data frame with two columns:
  \item{variable}{The variable name}
  \item{r}{The generalized partial correlation coefficient}
  \item{r_n}{The normalized generalized partial correlation coefficient}
  \item{algorithm}{The algorithm used to compute the upper/lower bounds of the generalized partial correlation coefficient (to compute its normalized version)}
}
\description{
Computes the normalized generalized partial correlation coefficient for binomial GLMs.
The normalization scales the correlation by its maximum possible absolute value.
}
\details{
The normalized generalized partial correlation is computed as:
\deqn{
r_n = \begin{cases}
+r / r_+ & \text{if } r > 0 \\
-r / r_- & \text{if } r < 0
\end{cases}
}
where \eqn{r_+} is the maximum possible correlation and \eqn{r_-} is the minimum.

When the (full) model has only intercept and only one predictor X, the
generalized (non partial) correlation is computed and the normalization factor
for X is exact.
In the more general case with more predictors, for sample sizes \eqn{n \leq n_{\text{exact}}}, brute force search is used to find
the exact extrema. For larger sample sizes, a greedy multi-start algorithm is employed:
\itemize{
  \item Multiple starting points are generated using thresholding and random sampling
  \item From each start, coordinates are greedily flipped to improve the correlation
  \item Early stopping is used when no improvements are found for several iterations
  \item The best solution across all starts is returned
}
This approach provides a good trade-off between computational efficiency and solution
quality for large problems where brute force is infeasible.
}
\examples{
set.seed(123)
dt=data.frame(X=rnorm(20),
   Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rbinom(n=20,prob=plogis((dt$Z=="C")*2),size=1)
mod=flipscores(Y~Z+X,data=dt,family="binomial",n_flips=1000)
summary(mod)

# Compute generalized partial correlations for all variables
(results <- gcor(mod))

# Compute for specific variables only
gcor(mod, variables = c("X", "ZC"))

# Compute generalized partial correlations for all variables
(results <- gcor_normalized_binom(mod))

# Compute for specific variables only
gcor_normalized_binom(mod, variables = c("X", "ZC"))


mod=glm(Y~1+X,data=dt,family="binomial")
summary(mod)
# Compute generalized partial correlations for all variables
(results <- gcor(mod))
# Compute generalized partial correlations for all variables
(results <- gcor_normalized_binom(mod))

}
