score_std=function(flp,scr_eff)
score_std=function(flp,scr_eff)
score_std=function(flp,scr_eff) {
# scr_eff #Ã¨ un vettore
numeratore=t(scr_eff)%*%flp
aflp= attributes(scr_eff)$scale_ob$a * flp
denominatore= sqrt(t(aflp)  %*% attributes(scr_eff)$scale_ob$B %*% aflp)
numeratore/denominatore
}
?t.test
n=nrow(Y)
set.seed(NULL)
.Random.seed
c(rng.kind, n1, n2)
.Random.seed[1]
.Random.seed[1]
.Random.seed[1]
library(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
#' set.seed(1)
set.seed(1)
dt=data.frame(X=rnorm(20),
Z=factor(rep(LETTERS[1:3],length.out=20)))
dt$Y=rpois(n=20,lambda=exp(dt$Z=="C"))
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "effective")
summary(mod)
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "effective")
model$scores
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(socket_compute_scores_and_flip)
debug(compute_scores)
undebug(compute_scores)
debug(.flip_test)
Y
length(Y)
nrow(Y)
Tobs
Tobs=Tobs[]
Tobs
Tobs=Tobs[,]
Tobs
replicate(n_flips, {
flp = 1 - 2 * rbinom(n, 1, 0.5)
.score_std(Y, flp)
})
n_flips
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
n_flips
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
m
m <- match(c("score_type", "n_flips", "alternative", "id",
"seed"), names(mf), 0L)
m
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(compute_scores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
score_type
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
devtools::document("C:\\Users\\livio\\Documents\\github\\flipscores")
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
flip_param_call
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
mf
dt
mf
model <- eval(mf, parent.frame())
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores:::socket_compute_scores_and_flip)
undebug(flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
id
flip_param_call$id
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
debug(flipscores:::socket_compute_scores_and_flip)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
results = eval(flip_param_call, parent.frame())
results
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
str(results)
mod
summary(mod)
mod$p.values
mod$scores
mod$Tspace
dim(mod$Tspace)
head(mod$Tspace)
colnames(model$x)
head(mod$scores)
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
summary(mod)
mod$p.values
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
summary(mod)
debug(summary.flipscores)
debug(flipscores:::summary.flipscores)
summary(mod)
names(object$p.values)
sum_model$coefficients[names(object$p.values), 5] = object$p.values
sum_model$coefficients[names(object$p.values), 2] = object$Tspace[1,
]
sapply(object$scores,
sd)
object$scores
nrow(object$scores)
sapply(object$scores,
sd) * sqrt(nrow(object$scores))
sum_model$coefficients[names(object$p.values), 3] = sapply(object$scores,
sd) * sqrt(nrow(object$scores))
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
summary(mod)
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
summary(mod)
debug(flipscores:::summary.flipscores)
summary(mod)
summary(mod)
summary(mod)
as.vector(sapply(object$scores,
sd) * sqrt(nrow(object$scores)))
names(object$p.values)
sum_model$coefficients[names(object$p.values), 3]
sum_model$coefficients
object$p.values
object$Tspace[1,
]
sum_model$coefficients=sum_model$coefficients[,c(1,1:4),drop=FALSE]
sum_model=summary.glm(object = object)
sum_model$coefficients=sum_model$coefficients[,c(1,1:4),drop=FALSE]
sum_model$coefficients[,-1]=NA
sum_model$coefficients[names(object$p.values),5]=object$p.values
sum_model$coefficients
sum_model$coefficients[names(object$p.values),2]=as.vector(object$Tspace[1,])
sum_model$coefficients
sum_model=summary.glm(object = object)
sum_model$coefficients=sum_model$coefficients[,c(1,1:4),drop=FALSE]
sum_model$coefficients[,-1]=NA
sum_model$coefficients[names(object$p.values),5]=object$p.values
as.vector(object$Tspace[1,])
as.vector(object$Tspace[1,,drop=TRUE])
unlist(object$Tspace[1,,drop=TRUE])
sum_model=summary.glm(object = object)
sum_model$coefficients=sum_model$coefficients[,c(1,1:4),drop=FALSE]
sum_model$coefficients[,-1]=NA
sum_model$coefficients[names(object$p.values),5]=object$p.values
sum_model$coefficients[names(object$p.values),2]=unlist(object$Tspace[1,,drop=TRUE])
sum_model$coefficients
sum_model$coefficients[names(object$p.values),3]=unlist(sapply(object$scores,sd)*sqrt(nrow(object$scores)))
sum_model$coefficients[,4]=sum_model$coefficients[,2]/sum_model$coefficients[,3]
sum_model$coefficients
# sum_model$coefficients=sum_model$coefficients[,c(1,4)]
colnames(sum_model$coefficients)[c(2,4)]=c("Score","z value")
sum_model$coefficients
devtools::install("C:\\Users\\livio\\Documents\\github\\flipscores")
debug(flipscores:::summary.flipscores)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized")
summary(mod)
mod=flipscores(Y~Z+X,data=dt,family="poisson",score_type = "standardized",to_be_tested=3)
summary(mod)
